if ENABLE_SSRPROGRAM

# This is messy but it works. If you know a better way, please tell me.
# This would obviously have been a lot easier if all projects used autotools, but I don't feel like
# setting up a new build system for a 3rd party library. Besides, cmake is probably a better build system,
# I only use automake because it is easier to package (at least for Ubuntu).

nodist_noinst_DATA = \
	libsoxr.a \
	soxr.h

.PHONY: soxr-make soxr-clean

soxr-make:
	mkdir -p "$(srcdir)/soxr/Release"
	cd "$(srcdir)/soxr/Release"; cmake -DCMAKE_BUILD_TYPE=Release -DBUILD_SHARED_LIBS=FALSE ..
	$(MAKE) -C "$(srcdir)/soxr/Release"
soxr-clean:
	rm -rf "$(srcdir)/soxr/Release"
libsoxr.a: soxr-make
	cp "$(srcdir)/soxr/Release/src/libsoxr.a" "$@"
soxr.h: $(srcdir)/soxr/src/soxr.h
	cp "$<" "$@"

clean-local: soxr-clean

endif
